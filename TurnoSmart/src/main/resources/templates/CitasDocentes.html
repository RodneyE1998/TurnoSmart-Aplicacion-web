<!DOCTYPE html>
<html dir="ltr" lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="keywords"
	content="dashboard, web, bootstrap, thymeleaf, spring boot, matrix lite" />
<meta name="description"
	content="Dashboard template using Thymeleaf and Bootstrap in Spring Boot" />
<meta name="robots" content="noindex,nofollow" />
<title>TurnoSmart</title>

<!-- Favicon -->
<link rel="icon" type="image/png" sizes="16x16"
	th:href="@{/assets/images/icono.png}" />

<!-- Material Design Icons -->
<link
	href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css"
	rel="stylesheet">

<!-- Bootstrap CSS -->
<link th:href="@{/assets/libs/bootstrap/dist/css/bootstrap.min.css}"
	rel="stylesheet" />

<!-- Select2 CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
	rel="stylesheet" />

<!-- Flatpickr CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
	rel="stylesheet" />

<!-- CSS Files -->
<link th:href="@{/assets/libs/flot/css/float-chart.css}"
	rel="stylesheet" />
<link th:href="@{/dist/css/style.min.css}" rel="stylesheet" />

<!-- Custom CSS -->
<style>
.select2-container .select2-selection--single {
	height: 38px;
}

.select2-container--default .select2-selection--single .select2-selection__rendered
	{
	line-height: 36px;
}
</style>

<style>
/* Estilos del Sidebar */
.sidebar-nav {
	display: flex;
	flex-direction: column;
	height: 100vh;
}

.sidebar-nav .menu-items {
	flex-grow: 1;
}

/* Estilos para el contenedor de bienvenida */
.page-content {
	background-color: #f4f5f7;
	border-radius: 10px;
	box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
	padding: 40px;
	max-width: 800px;
	margin: 40px auto;
	text-align: center;
}

.page-content h1 {
	font-size: 2em;
	color: #333;
	margin-bottom: 10px;
}

.page-content p {
	color: #555;
	font-size: 1.2em;
}

/* Animación de cambio de color en el texto del footer */
.footer p {
	transition: color 1s ease;
	animation: colorChange 5s infinite;
}
</style>
</head>
<body>
	<!-- Preloader -->
	<div class="preloader">
		<div class="lds-ripple">
			<div class="lds-pos"></div>
			<div class="lds-pos"></div>
		</div>
	</div>

	<!-- Main Wrapper -->
	<div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5"
		data-sidebartype="full" data-sidebar-position="absolute"
		data-header-position="absolute" data-boxed-layout="full">

		<!-- Topbar Header -->
		<header class="topbar" data-navbarbg="skin5">
			<nav class="navbar top-navbar navbar-expand-md navbar-dark">
				<div class="navbar-header" data-logobg="skin5">
					<a class="navbar-brand" th:href="@{/docente/PrincipalDocente}">
						<b class="logo-icon ps-2"> <img
							th:src="@{/assets/images/icono.png}" alt="TurnoSmart Logo"
							class="light-logo" width="25" />
					</b> <span class="logo-text ms-2"
						style="color: orange; font-family: 'Arial', sans-serif; font-size: 24px;">
							TurnoSmart </span>
					</a> <a class="nav-toggler waves-effect waves-light d-block d-md-none"
						href="javascript:void(0)"> <i class="ti-menu ti-close"></i>
					</a>
				</div>

				<div class="navbar-collapse collapse" id="navbarSupportedContent"
					data-navbarbg="skin5">
					<ul class="navbar-nav float-start me-auto">
						<li class="nav-item d-none d-lg-block"><a
							class="nav-link sidebartoggler waves-effect waves-light"
							href="javascript:void(0)" data-sidebartype="mini-sidebar"> <i
								class="mdi mdi-menu font-24"></i>
						</a></li>
					</ul>
					<span class="perfil-docente text-white"
						style="font-family: 'Arial', sans-serif; font-size: 20px; margin-left: auto; margin-right: 20px;">
						UNIDAD EDUCATIVA PARTICULAR "ANTONIO FLORES" </span>
				</div>
			</nav>
		</header>

		<!-- ============================================================== -->
		<!-- Left Sidebar BARRA LATERAL-->
		<!-- ============================================================== -->
		<aside class="left-sidebar" data-sidebarbg="skin5">
			<div class="scroll-sidebar">
				<nav class="sidebar-nav">
					<ul id="sidebarnav" class="pt-4">
						<li class="sidebar-item"><a
							class="sidebar-link has-arrow waves-effect waves-dark"
							href="javascript:void(0)" aria-expanded="false"><i
								class="mdi mdi-face"></i><span class="hide-menu">Perfil </span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item"><a href="/docente/Perfil"
									class="sidebar-link"><i class="mdi mdi-emoticon"></i><span
										class="hide-menu"> USUARIO </span></a></li>
							</ul></li>
						<li class="sidebar-item"><a
							class="sidebar-link has-arrow waves-effect waves-dark"
							href="javascript:void(0)" aria-expanded="false"><i
								class="mdi mdi-receipt"></i><span class="hide-menu">CITAS
							</span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item"><a href="/docente/citas"
									class="sidebar-link"><i class="mdi mdi-note-outline"></i><span
										class="hide-menu"> AGENDAR CITAS </span></a></li>
								<li class="sidebar-item"><a href="/docente/citas/agendadas"
									class="sidebar-link"><i class="mdi mdi-note-plus"></i><span
										class="hide-menu"> CITAS AGENDADAS </span></a></li>
							</ul></li>
						<li class="sidebar-item"><a
							class="sidebar-link waves-effect waves-dark sidebar-link"
							href="/docente/horarios" aria-expanded="false"> <i
								class="mdi mdi-view-dashboard"></i><span class="hide-menu">Horarios</span>
						</a></li>
						<li class="sidebar-item"><a
							class="sidebar-link waves-effect waves-dark sidebar-link"
							href="/docente/reportes" aria-expanded="false"><i
								class="mdi mdi-chart-bubble"></i><span class="hide-menu">Reportes
									y Estadísticas</span></a></li>
						<!-- Agregar elementos <li> vacíos para espacio adicional -->
						<li class="sidebar-item" style="height: 250px;"></li>
						<li class="sidebar-item" style="height: 250px;"></li>
						<li class="sidebar-item" style="height: 250px;"></li>
						<!-- Espacio en blanco para empujar el botón de Logout hacia abajo -->
						<li class="sidebar-item mt-auto"><a
							class="sidebar-link waves-effect waves-dark sidebar-link text-danger"
							th:href="@{/logout}" aria-expanded="false"> <i
								class="mdi mdi-logout"></i><span class="hide-menu">Cerrar
									Sesión</span>
						</a></li>
					</ul>
				</nav>
			</div>
		</aside>

		<!-- Page Content -->

		<!-- Logo del Colegio -->
		<div class="page-wrapper">
			<div style="text-align: center; margin-top: 20px;">
				<img
					src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTu1b3tsol6AvxLvoFz9suaU05kfP5jusUw1w&s"
					alt="Logo del Colegio"
					style="max-width: 200px; border-radius: 10px;">
			</div>

			<!--/* 
			<!-- Imágenes de los Horarios -->
			<div
				style="display: flex; justify-content: space-around; align-items: center; margin-top: 30px;">
				<!-- Imagen del Horario Básica -->
				<img th:src="@{/assets/images/HorarioBasica.png}"
					alt="Horario Básica"
					style="max-width: 45%; border: 1px solid #ccc; border-radius: 10px;">

				<!-- Imagen del Horario Bachillerato -->
				<img th:src="@{/assets/images/HorarioBachillerato.png}"
					alt="Horario Bachillerato"
					style="max-width: 45%; border: 1px solid #ccc; border-radius: 10px;">
			</div>
			*/-->

			<div class="page-content">
				<h1>AGENDA TU CITA CON EL REPRESENTANTE</h1>
				<form th:action="@{/docente/citas/agendar}" method="post">
					<div class="form-group">
						<label for="idEstudiante" style="font-size: 18px;">Seleccionar
							Estudiante:</label> <select id="idEstudiante" name="idEstudiante"
							class="form-control select2" required>
							<option value="" disabled selected>-- Seleccionar
								Estudiante --</option>
							<th:block th:each="estudiante : ${estudiantes}">
								<option th:value="${estudiante.idEstudiante}"
									th:text="${estudiante.nombre + ' ' + estudiante.apellido}"></option>
							</th:block>
						</select>
					</div>
					<div class="form-group">
						<label for="fecha" style="font-size: 18px;">Escoge la
							fecha:</label> <input type="text" id="fecha" name="fechaCita"
							class="form-control" placeholder="Selecciona la fecha" required>
					</div>
					<div class="form-group">
						<label for="hora" style="font-size: 18px;">Escoge la hora:</label>
						<input type="text" id="hora" name="horaCita" class="form-control"
							placeholder="Selecciona la hora" required>
					</div>
					<!-- Tipo de Cita -->
					<div class="form-group">
						<label for="tipoCita" style="font-size: 18px;">Tipo de
							Cita:</label> <select id="tipoCita" name="tipoCita" class="form-control"
							required>
							<option value="" disabled selected>-- Seleccionar Tipo
								de Cita --</option>
							<option value="ACADEMICO">Académico</option>
							<option value="DISCIPLINARIO">Disciplinario</option>
						</select>
					</div>

					<!-- Motivo de la Cita -->
					<div class="form-group">
						<label for="motivoCita" style="font-size: 18px;">Motivo de
							la Cita:</label>
						<textarea id="motivoCita" name="motivoCita" class="form-control"
							rows="3"
							placeholder="Escriba el motivo de la cita (máximo 150 caracteres)"
							maxlength="150" required></textarea>
					</div>
					<button type="submit" class="btn btn-success"
						style="font-size: 18px; padding: 15px 30px;">Agendar Cita</button>
				</form>
			</div>
		</div>

		<!-- ============================================================== -->
		<!-- Footer Dinámico   -->
		<!-- ============================================================== -->
		<div class="row">
			<footer class="footer text-center">
				<p>
					All Rights Reserved by TurnoSmart. Designed and Developed by <a
						href="https://www.wrappixel.com">RodneyEscobar</a>.
				</p>
			</footer>
		</div>
	</div>

	<!-- JavaScript Files -->
	<script th:src="@{/assets/libs/jquery/dist/jquery.min.js}"></script>
	<script
		th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
	<script
		th:src="@{/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js}"></script>
	<script th:src="@{/dist/js/waves.js}"></script>
	<script th:src="@{/dist/js/sidebarmenu.js}"></script>
	<script th:src="@{/dist/js/custom.min.js}"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


	<!-- Agrega los estilos y scripts de Flatpickr -->
	<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

	<!-- Inicialización de Select2 y Flatpickr -->
	<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Inicializar Select2 para el selector de estudiantes
        $('#idEstudiante').select2({
            placeholder: "-- Seleccionar Estudiante --",
            allowClear: true
        });

        // Obtener referencias a los inputs
        let fechaInput = document.getElementById("fecha");
        let horaInput = document.getElementById("hora");

        // Inicializar Flatpickr para la fecha con restricción de mínimo hoy
        let fechaFlatpickr = flatpickr(fechaInput, {
            dateFormat: "Y-m-d",
            minDate: "today",
            locale: {
                firstDayOfWeek: 1,
                weekdays: {
                    shorthand: ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"],
                    longhand: ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"]
                },
                months: {
                    shorthand: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                    longhand: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"]
                }
            },
            onChange: function () {
                actualizarHorasDisponibles(); // Llamar cuando se cambie la fecha
            }
        });

        // Inicializar Flatpickr para la hora
        let horaFlatpickr = flatpickr(horaInput, {
            enableTime: true,
            noCalendar: true,
            dateFormat: "H:i",
            time_24hr: true
        });

        // Función para actualizar las horas disponibles
        function actualizarHorasDisponibles() {
            let fechaSeleccionada = new Date(fechaInput.value);
            let hoy = new Date();
            hoy.setHours(0, 0, 0, 0); // Eliminar la parte de la hora para comparación

            if (fechaSeleccionada.getTime() === hoy.getTime()) {
                let horaActual = new Date();
                let minHora = horaActual.getHours().toString().padStart(2, '0') + ":" + 
                              horaActual.getMinutes().toString().padStart(2, '0');

                // Destruir y reinicializar Flatpickr con la nueva restricción de minTime
                horaFlatpickr.destroy();
                horaFlatpickr = flatpickr(horaInput, {
                    enableTime: true,
                    noCalendar: true,
                    dateFormat: "H:i",
                    time_24hr: true,
                    minTime: minHora // Restringir a partir de la hora actual
                });

                // Validar si el usuario ya ha seleccionado una hora inválida
                setTimeout(() => {
                    if (horaInput.value && horaInput.value < minHora) {
                        alert("No puedes seleccionar una hora anterior a la actual.");
                        horaFlatpickr.setDate(minHora, true);
                    }
                }, 100);
            } else {
                // Si la fecha es futura, permitir cualquier hora
                horaFlatpickr.destroy();
                horaFlatpickr = flatpickr(horaInput, {
                    enableTime: true,
                    noCalendar: true,
                    dateFormat: "H:i",
                    time_24hr: true,
                    minTime: "00:00" // Sin restricción
                });
            }
        }
    });
</script>

</body>
</html>
