<!DOCTYPE html>
<html dir="ltr" lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="keywords"
	content="dashboard, web, bootstrap, thymeleaf, spring boot, matrix lite" />
<meta name="description"
	content="Dashboard template using Thymeleaf and Bootstrap in Spring Boot" />
<meta name="robots" content="noindex,nofollow" />
<title>TurnoSmart</title>

<!-- Favicon -->
<link rel="icon" type="image/png" sizes="16x16"
	th:href="@{/assets/images/icono.png}" />

<!-- Agrega el CSS de Material Design Icons -->
<link
	href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css"
	rel="stylesheet">

<!-- CSS Files -->
<link th:href="@{/assets/libs/flot/css/float-chart.css}"
	rel="stylesheet" />
<link th:href="@{/dist/css/style.min.css}" rel="stylesheet" />

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

<!-- Bootstrap Bundle -->
<script
	th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>

<!-- CSS -->
<link
	href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap4.min.css"
	rel="stylesheet" />
<link th:href="@{/assets/libs/bootstrap/dist/css/bootstrap.min.css}"
	rel="stylesheet" />

<!-- JavaScript -->
<script th:src="@{/assets/libs/jquery/dist/jquery.min.js}"></script>
<script
	th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
<script
	src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script
	src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap4.min.js"></script>

<style>
/* Estilos del Sidebar */
.sidebar-nav {
	display: flex;
	flex-direction: column;
	height: 100vh;
}

.sidebar-nav .menu-items {
	flex-grow: 1;
}

/* Estilos para el contenedor de bienvenida */
.page-content {
	background-color: #f4f5f7;
	border-radius: 10px;
	box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
	padding: 40px;
	max-width: 800px;
	margin: 40px auto;
	text-align: center;
}

.page-content h1 {
	font-size: 2em;
	color: #333;
	margin-bottom: 10px;
}

.page-content p {
	color: #555;
	font-size: 1.2em;
}

/* Animación de cambio de color en el texto del footer */
.footer p {
	transition: color 1s ease;
	animation: colorChange 5s infinite;
}
</style>

<style>
.table-header-dark th {
	color: #111; /* Color letras de la Tabla*/
	font-size: 18px; /* Tamaño más grande para las palabras */
	font-weight: bold; /* Hace el texto más prominente */
	text-transform: uppercase; /* Opcional: letras en mayúsculas */
}
</style>

<style>
/* Ajusta el ancho de las columnas según el contenido */
#zero_config th, #zero_config td {
	white-space: nowrap; /* Evita saltos de línea en el contenido */
}

/* Ejemplo de ajuste específico para columnas */
#zero_config td:nth-child(1), #zero_config th:nth-child(1) {
	width: 10%; /* Ajusta el ancho para la primera columna */
}

#zero_config td:nth-child(2), #zero_config th:nth-child(2) {
	width: 20%; /* Ajusta el ancho para la columna de Estudiante */
}

#zero_config td:nth-child(3), #zero_config th:nth-child(3) {
	width: 20%; /* Ajusta el ancho para la columna de Representante */
}
/* Ajusta otras columnas según sea necesario */
</style>
<style>
/* Ajusta el ancho de las columnas según el contenido */
#zero_config1 th, #zero_config1 td {
	white-space: nowrap; /* Evita saltos de línea en el contenido */
}

/* Ejemplo de ajuste específico para columnas */
#zero_config1 td:nth-child(1), #zero_config1 th:nth-child(1) {
	width: 10%; /* Ajusta el ancho para la primera columna */
}

#zero_config1 td:nth-child(2), #zero_config1 th:nth-child(2) {
	width: 20%; /* Ajusta el ancho para la columna de Estudiante */
}

#zero_config1 td:nth-child(3), #zero_config1 th:nth-child(3) {
	width: 20%; /* Ajusta el ancho para la columna de Representante */
}
/* Ajusta otras columnas según sea necesario */
</style>

</head>

<body>

	<!-- ============================================================== -->
	<!-- Preloader -->
	<!-- ============================================================== -->
	<div class="preloader">
		<div class="lds-ripple">
			<div class="lds-pos"></div>
			<div class="lds-pos"></div>
		</div>
	</div>

	<!-- ============================================================== -->
	<!-- Main Wrapper -->
	<!-- ============================================================== -->
	<div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5"
		data-sidebartype="full" data-sidebar-position="absolute"
		data-header-position="absolute" data-boxed-layout="full">

		<!-- ============================================================== -->
		<!-- Topbar Header -->
		<!-- ============================================================== -->
		<header class="topbar" data-navbarbg="skin5">
			<nav class="navbar top-navbar navbar-expand-md navbar-dark">
				<div class="navbar-header" data-logobg="skin5">
					<a class="navbar-brand"
						th:href="@{/representante/PrincipalRepresentante}"> <b
						class="logo-icon ps-2"> <img
							th:src="@{/assets/images/icono.png}" alt="TurnoSmart Logo"
							class="light-logo" width="25" />
					</b> <span class="logo-text ms-2"
						style="color: orange; font-family: 'Arial', sans-serif; font-size: 24px;">
							TurnoSmart </span>
					</a> <a class="nav-toggler waves-effect waves-light d-block d-md-none"
						href="javascript:void(0)"> <i class="ti-menu ti-close"></i>
					</a>
				</div>

				<div class="navbar-collapse collapse" id="navbarSupportedContent"
					data-navbarbg="skin5">
					<ul class="navbar-nav float-start me-auto">
						<li class="nav-item d-none d-lg-block"><a
							class="nav-link sidebartoggler waves-effect waves-light"
							href="javascript:void(0)" data-sidebartype="mini-sidebar"> <i
								class="mdi mdi-menu font-24"></i>
						</a></li>
					</ul>
					<span class="perfil-docente text-white"
						style="font-family: 'Arial', sans-serif; font-size: 20px; margin-left: auto; margin-right: 20px;">
						UNIDAD EDUCATIVA PARTICULAR "ANTONIO FLORES" </span>
				</div>
			</nav>
		</header>

		<!-- ============================================================== -->
		<!-- Left Sidebar BARRA LATERAL-->
		<!-- ============================================================== -->
		<aside class="left-sidebar" data-sidebarbg="skin5">
			<div class="scroll-sidebar">
				<nav class="sidebar-nav">
					<ul id="sidebarnav" class="pt-4">
						<li class="sidebar-item"><a
							class="sidebar-link has-arrow waves-effect waves-dark"
							href="javascript:void(0)" aria-expanded="false"><i
								class="mdi mdi-receipt"></i><span class="hide-menu">Docentes
							</span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item"><a
									href="/representante/DocentesBasica" class="sidebar-link">
										<i class="mdi mdi-note-outline"></i> <span class="hide-menu">
											Básica Superior </span>
								</a></li>
								<li class="sidebar-item"><a
									href="/representante/DocentesBachillerato" class="sidebar-link"><i
										class="mdi mdi-note-plus"></i><span class="hide-menu">
											Bachillerato </span></a></li>
							</ul></li>
						<li class="sidebar-item"><a
							class="sidebar-link has-arrow waves-effect waves-dark"
							href="javascript:void(0)" aria-expanded="false"><i
								class="mdi mdi-face"></i><span class="hide-menu">Perfil </span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item"><a
									href="/representante/Perfil-Representante" class="sidebar-link"><i
										class="mdi mdi-emoticon"></i><span class="hide-menu">
											USUARIO </span></a></li>
							</ul></li>
						<li class="sidebar-item"><a
							class="sidebar-link has-arrow waves-effect waves-dark"
							href="javascript:void(0)" aria-expanded="false"><i
								class="mdi mdi-account-key"></i><span class="hide-menu">CITAS
							</span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item"><a href="/representante/Citas"
									class="sidebar-link"><i class="mdi mdi-all-inclusive"></i><span
										class="hide-menu"> Agendar Cita </span></a></li>
								<li class="sidebar-item"><a
									href="/representante/citas-agendadas" class="sidebar-link"><i
										class="mdi mdi-all-inclusive"></i><span class="hide-menu">
											Citas Agendadas </span></a></li>
							</ul></li>
						<!-- Agregar elementos <li> vacíos para espacio adicional -->
						<li class="sidebar-item" style="height: 250px;"></li>
						<li class="sidebar-item" style="height: 250px;"></li>
						<li class="sidebar-item" style="height: 250px;"></li>
						<li class="sidebar-item" style="height: 250px;"></li>
						<li class="sidebar-item" style="height: 250px;"></li>
						<!-- Espacio en blanco para empujar el botón de Logout hacia abajo -->
						<li class="sidebar-item mt-auto"><a
							class="sidebar-link waves-effect waves-dark sidebar-link text-danger"
							th:href="@{/logout}" aria-expanded="false"> <i
								class="mdi mdi-logout"></i><span class="hide-menu">Cerrar
									Sesión</span>
						</a></li>
					</ul>
				</nav>
			</div>
		</aside>

		<div class="page-wrapper">
			<!-- ============================================================== -->
			<!-- Bread crumb and right sidebar toggle -->
			<!-- ============================================================== -->

			<!-- Imagen del Colegio -->
			<div style="text-align: center; margin-top: 20px;">
				<img
					src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTu1b3tsol6AvxLvoFz9suaU05kfP5jusUw1w&s"
					alt="Logo del Colegio"
					style="max-width: 200px; border-radius: 10px;">
			</div>

			<!-- Contenido Principal -->
			<div class="container mt-5">

				<!-- Tabla: Citas Solicitadas por el Representante -->
				<div class="card">
					<div class="card-body">
						<h5 class="card-title">Citas Solicitadas por el Representante</h5>
						<div class="table-responsive">
							<table id="zero_config"
								class="table table-striped table-bordered">
								<thead>
									<tr class="text-center">
										<th>#</th>
										<th>Docente</th>
										<th>Detalles</th>
										<th>Fecha</th>
										<th>Hora</th>
										<th>Estado</th>
										<th>Acciones</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="cita, iterStat : ${citasPorRepresentante}">
										<th scope="row" th:text="${iterStat.index + 1}"></th>

										<!-- Columna: Docente -->
										<td
											th:text="${cita.docentes[0].nombre + ' ' + cita.docentes[0].apellido}"
											class="text-center"></td>

										<!-- Columna: Botón Ver Detalle -->
										<td class="text-center">
											<button class="btn btn-info btn-sm"
												th:data-bs-target="'#detalleCitaModal' + ${cita.idCita}"
												data-bs-toggle="modal">Ver Detalle</button>
										</td>

										<!-- Columna: Fecha -->
										<td class="text-center"><input type="date"
											class="form-control"
											th:value="${#temporals.format(cita.fechaCita, 'yyyy-MM-dd')}"
											disabled /></td>

										<!-- Columna: Hora -->
										<td class="text-center"><input type="time"
											class="form-control"
											th:value="${#temporals.format(cita.horaCita, 'HH:mm')}"
											disabled /></td>

										<!-- Columna: Estado -->
										<td th:text="${cita.estadoCita}" class="text-center"></td>

										<!-- Columna: Acciones -->
										<td class="text-center">
											<button class="btn btn-danger btn-sm"
												th:onclick="'cancelarCita(' + ${cita.idCita} + ')'">
												Cancelar Cita</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<!-- Modales de Detalles para cada Cita -->
				<div th:each="cita : ${citasPorRepresentante}">
					<div class="modal fade" th:id="'detalleCitaModal' + ${cita.idCita}"
						tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title">Detalles de la Cita</h5>
									<button type="button" class="close" data-bs-dismiss="modal"
										aria-label="Cerrar">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<p>
										<strong>Docente:</strong> <span
											th:text="${cita.docentes[0].nombre + ' ' + cita.docentes[0].apellido}"></span>
									</p>
									<p>
										<strong>Fecha:</strong> <span th:text="${cita.fechaCita}"></span>
									</p>
									<p>
										<strong>Hora:</strong> <span th:text="${cita.horaCita}"></span>
									</p>
									<p>
										<strong>Tipo de Cita:</strong> <span
											th:text="${cita.tipoCita}"></span>
									</p>
									<p>
										<strong>Motivo:</strong> <span th:text="${cita.motivoCita}"></span>
									</p>
								</div>
								<div class="modal-footer text-center">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Cerrar</button>
								</div>
							</div>
						</div>
					</div>
				</div>



				<!-- Tabla: Citas Solicitadas por los Docentes -->
				<div class="card">
					<div class="card-body">
						<h5 class="card-title">Citas Solicitadas por los Docentes</h5>
						<div class="table-responsive">
							<table id="zero_config1"
								class="table table-striped table-bordered">
								<thead>
									<tr class="text-center">
										<th>#</th>
										<th>Docente</th>
										<th>Detalles</th>
										<th>Fecha</th>
										<th>Hora</th>
										<th>Estudiante</th>
										<th>Estado</th>
										<th>Acciones</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="cita, iterStat : ${citasPorDocente}">
										<th scope="row" th:text="${iterStat.index + 1}"></th>

										<!-- Columna: Docente -->
										<td
											th:text="${cita.docentes[0].nombre + ' ' + cita.docentes[0].apellido}"
											class="text-center"></td>

										<!-- Columna: Botón Ver Detalle -->
										<td class="text-center">
											<button class="btn btn-info btn-sm"
												th:data-bs-target="'#detalleCitaModal' + ${cita.idCita}"
												data-bs-toggle="modal">Ver Detalle</button>
										</td>

										<!-- Columna: Fecha -->
										<td class="text-center"><input type="date"
											class="form-control"
											th:value="${#temporals.format(cita.fechaCita, 'yyyy-MM-dd')}"
											disabled /></td>

										<!-- Columna: Hora -->
										<td class="text-center"><input type="time"
											class="form-control"
											th:value="${#temporals.format(cita.horaCita, 'HH:mm')}"
											disabled /></td>

										<!-- Columna: Estudiante -->
										<td
											th:text="${cita.estudiante.nombre + ' ' + cita.estudiante.apellido}"
											class="text-center"></td>

										<!-- Columna: Estado -->
										<td th:text="${cita.estadoCita}" class="text-center"></td>

										<!-- Columna: Acciones -->
										<td class="text-center">
											<!-- Botón Confirmar -->
											<button class="btn btn-success btn-sm"
												th:if="${cita.estadoCita == 'PENDIENTE'}"
												th:onclick="'confirmarCita(' + ${cita.idCita} + ')'">
												Confirmar</button> <!-- Botón Cancelar -->
											<button class="btn btn-danger btn-sm"
												th:onclick="'cancelarCita(' + ${cita.idCita} + ')'">
												Cancelar</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<!-- Modales de Detalles para cada Cita -->
				<div th:each="cita : ${citasPorDocente}">
					<div class="modal fade" th:id="'detalleCitaModal' + ${cita.idCita}"
						tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title">Detalles de la Cita</h5>
									<button type="button" class="close" data-bs-dismiss="modal"
										aria-label="Cerrar">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<p>
										<strong>Docente:</strong> <span
											th:text="${cita.docentes[0].nombre + ' ' + cita.docentes[0].apellido}"></span>
									</p>
									<p>
										<strong>Fecha:</strong> <span th:text="${cita.fechaCita}"></span>
									</p>
									<p>
										<strong>Hora:</strong> <span th:text="${cita.horaCita}"></span>
									</p>
									<p>
										<strong>Estudiante:</strong> <span
											th:text="${cita.estudiante.nombre + ' ' + cita.estudiante.apellido}"></span>
									</p>
									<p>
										<strong>Tipo de Cita:</strong> <span
											th:text="${cita.tipoCita}"></span>
									</p>
									<p>
										<strong>Motivo:</strong> <span th:text="${cita.motivoCita}"></span>
									</p>
								</div>
								<div class="modal-footer text-center">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Cerrar</button>
								</div>
							</div>
						</div>
					</div>
				</div>





				<!-- ============================================================== -->
				<!-- Footer Dinámico -->
				<!-- ============================================================== -->
				<footer class="footer text-center mt-5">
					<p>
						All Rights Reserved by TurnoSmart. Designed and Developed by <a
							href="https://www.wrappixel.com" target="_blank">Rodney
							Escobar</a>.
					</p>
				</footer>
			</div>

			<!-- ============================================================== -->
			<!-- JavaScript Files -->
			<script th:src="@{/assets/libs/jquery/dist/jquery.min.js}"></script>
			<script
				th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
			<script
				th:src="@{/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js}"></script>
			<script th:src="@{/dist/js/waves.js}"></script>
			<script th:src="@{/dist/js/sidebarmenu.js}"></script>
			<script th:src="@{/dist/js/custom.min.js}"></script>
			<script th:src="@{/assets/extra-libs/sparkline/sparkline.js}"></script>
			<!-- this page js -->
			<script
				th:src="@{/assets/extra-libs/multicheck/datatable-checkbox-init.js}"></script>
			<script
				th:src="@{/assets/extra-libs/multicheck/jquery.multicheck.js}"></script>
			<script th:src="@{/assets/extra-libs/DataTables/datatables.min.js}"></script>

			<!-- Inicialización de DataTables -->
			<script>
				$(document)
						.ready(
								function() {
									$('#zero_config')
											.DataTable(
													{
														
														paging : true,
														searching : true,
														info : true,
														lengthChange : true,
														pageLength : 5,
														autoWidth : false, // Desactiva el ancho automático para permitir personalización
														language : {
															lengthMenu : "Mostrar _MENU_ registros por página",
															zeroRecords : "No se encontraron resultados",
															info : "Mostrando _START_ a _END_ de _TOTAL_ registros",
															infoEmpty : "Mostrando 0 a 0 de 0 registros",
															infoFiltered : "(filtrado de _MAX_ registros totales)",
															search : "Buscar:",
															paginate : {
																previous : "Anterior",
																next : "Siguiente"
															}
														}
													});
								});
			</script>
			<script>
				$(document)
						.ready(
								function() {
									$('#zero_config1')
											.DataTable(
													{
													
														paging : true,
														searching : true,
														info : true,
														lengthChange : true,
														pageLength : 5,
														autoWidth : false, // Desactiva el ancho automático para permitir personalización
														language : {
															lengthMenu : "Mostrar _MENU_ registros por página",
															zeroRecords : "No se encontraron resultados",
															info : "Mostrando _START_ a _END_ de _TOTAL_ registros",
															infoEmpty : "Mostrando 0 a 0 de 0 registros",
															infoFiltered : "(filtrado de _MAX_ registros totales)",
															search : "Buscar:",
															paginate : {
																previous : "Anterior",
																next : "Siguiente"
															}
														}
													});
								});
			</script>

			<script>
		//Cancelar cita de docente a representante y de representante a docente. 
		function cancelarCita(idCita) {
		    if (confirm("¿Estás seguro de que deseas cancelar esta cita?")) {
		        fetch('/representante/cancelar-cita', {
		            method: 'POST',
		            headers: {
		                'Content-Type': 'application/x-www-form-urlencoded'
		            },
		            body: `idCita=${idCita}`
		        })
		        .then(response => {
		            if (response.ok) {
		                return response.text();
		            } else {
		                throw new Error('Error al cancelar la cita');
		            }
		        })
		        .then(message => {
		            alert(message); // Mostrar mensaje de éxito
		            location.reload(); // Refrescar la página
		        })
		        .catch(error => {
		            alert(error.message);
		        });
		    }
		}
</script>

			<script>
		//Confirmar Cita de docente a representante 
function confirmarCita(idCita) {
    if (confirm("¿Estás seguro de que deseas confirmar esta cita?")) {
        fetch('/representante/confirmar-cita', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `idCita=${idCita}`
        })
        .then(response => {
            if (response.ok) {
                return response.text();
            } else {
                throw new Error('Error al confirmar la cita');
            }
        })
        .then(message => {
            alert(message);
            location.reload(); // Refrescar la página para ver los cambios
        })
        .catch(error => {
            alert(error.message);
        });
    }
}
</script>
</body>
</html>


